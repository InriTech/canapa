<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Canapa Delight - Premium Cannabis Products in South Africa</title>
    <meta name="description" content="Discover Canapa Delights for premium cannabis products in South Africa. Explore our collection of edibles, vapes, oils, cookies, gummies, and more. Quality and delight, delivered.">
    <meta name="keywords" content="canapa delights, cannabis South Africa, edibles, vapes, THC, CBD, online cannabis store, premium cannabis, cookies, gummies, oils, tea">
    <link rel="canonical" href="https://canapadelights.co.za/index.html">

    <meta property="og:type" content="website">
    <meta property="og:url" content="https://canapadelights.co.za/index.html">
    <meta property="og:title" content="Canapa Delight - Premium Cannabis Products Home">
    <meta property="og:description" content="Your trusted source for high-quality cannabis edibles, vapes, oils, and more in South Africa. Experience Canapa Delights.">
    <meta property="og:image" content="https://canapadelights.co.za/assets/img/logo-social.png"> <meta property="og:site_name" content="Canapa Delights">

    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://canapadelights.co.za/index.html">
    <meta property="twitter:title" content="Canapa Delight - Premium Cannabis Products Home">
    <meta property="twitter:description" content="Your trusted source for high-quality cannabis edibles, vapes, oils, and more in South Africa.">
    <meta property="twitter:image" content="https://canapadelights.co.za/assets/img/logo-social.png">

    <meta name="theme-color" content="#F28123"> <link rel="shortcut icon" type="image/png" href="assets/img/favicon.png">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Poppins:400,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/all.min.css">
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/owl.carousel.css">
    <link rel="stylesheet" href="assets/css/magnific-popup.css">
    <link rel="stylesheet" href="assets/css/animate.css">
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="assets/css/responsive.css">

    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "name": "Canapa Delights",
        "url": "https://canapadelights.co.za/index.html",
        "potentialAction": {
            "@type": "SearchAction",
            "target": {
                "@type": "EntryPoint",
                "urlTemplate": "https://canapadelights.co.za/shop.html?q={search_term_string}"
            },
            "query-input": "required name=search_term_string"
        },
        "publisher": {
            "@type": "Organization",
            "name": "Canapa Delights",
            "url": "https://canapadelights.co.za/",
            "logo": {
                "@type": "ImageObject",
                "url": "https://canapadelights.co.za/assets/img/logo.png",
                "width": 180, 
                "height": 40 
            },
            "sameAs": [
                "https://facebook.com/yourpage", 
                "https://instagram.com/yourpage" 
            ],
            "contactPoint": {
                "@type": "ContactPoint",
                "telephone": "+27-71-031-4435",
                "contactType": "Customer Service",
                "areaServed": "ZA",
                "availableLanguage": "en"
            }
        }
    }
    </script>

    <style>
        /* --- PRELOADER STYLES --- */
        #preloader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #fff; /* Use a light background for this page */
            z-index: 9999;
            display: flex; /* Using flex to help center the absolute positioned child */
            justify-content: center;
            align-items: center;
            transition: opacity 0.5s ease;
        }
        .progress-loader {
            width: 150px;
            background: rgba(236, 236, 238, 0.253);
            height: 3px;
            border-radius: 7px;
        }
        .progress {
            width: 1px;
            height: 3px;
            border-radius: 7px;
            background: #90EE90; /* Adjusted to match page theme */
            transition: 0.5s;
            animation: loading1274 2s ease infinite;
        }
        @keyframes loading1274 {
            0% { width: 0%; }
            10% { width: 10%; }
            50% { width: 40%; }
            60% { width: 60%; }
            100% { width: 100%; }
        }

        /* --- REST OF THE STYLES --- */
        #ageVerificationPopup { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 10001; background-color: white; padding: 20px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); text-align: center; width: 300px; display: none; }
        #ageVerificationPopup .ageHeading { font-size: 1.5em; font-weight: bold; margin-bottom: 10px; }
        #ageVerificationPopup .ageDescription { font-size: 0.9em; margin-bottom: 20px; }
        #ageVerificationPopup .buttonContainer { display: flex; justify-content: center; gap: 20px; }
        #ageVerificationPopup .confirmButton, #ageVerificationPopup .declineButton { padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; }
        #ageVerificationPopup .confirmButton { background-color: #90EE90; color: white; }
        #ageVerificationPopup .declineButton { background-color: #dadada; color: black; }
        #overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.7); z-index: 10000; display: none; }
        .modal { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 30px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.2); z-index: 10001; width: 320px; display: none; pointer-events: auto; }
        .modal h2 { margin-bottom: 20px; text-align: center; font-size: 1.8em; }
        .modal input { width: 100%; padding: 10px; margin-bottom: 15px; border: 1px solid #ddd; border-radius: 4px; pointer-events: auto; font-size:16px; }
        .modal button { width: 100%; padding: 10px; background: #90EE90; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; transition: background-color 0.2s; }
        .modal button:hover { background: #7ED957; }
        .modal button[type="button"] { background: #ccc; margin-top: 10px; }
        .modal button[type="button"]:hover { background: #bbb; }
        .modal p { text-align: center; margin-top: 15px; }
        .modal a { color: #90EE90; text-decoration: none; }
        .modal a:hover { text-decoration: underline; }
        .error-message { color: #ff4444; text-align: center; margin-top: 10px; font-size: 14px; min-height: 1.2em; }
        .password-strength { font-size: 12px; margin-top: -10px; margin-bottom: 10px; height: 15px; }
        .password-container { position: relative; }
        .password-toggle { position: absolute; top: 30%; right: 10px; transform: translateY(-50%); cursor: pointer; color: #aaa; }
        .main-menu-wrap { position: relative; }
        .hamburger-menu { display: none; cursor: pointer; position: absolute; top: 50%; right: 15px; transform: translateY(-50%); z-index: 1002; }
        .hamburger-menu .bar { width: 25px; height: 3px; background-color: #051922; margin: 5px 0; transition: 0.4s; }
        .main-menu { text-align: right; }
        .main-menu ul { margin: 0; padding: 0; list-style: none; }
        .main-menu ul li { display: inline-block; margin-left: 25px; position:relative; }
        .main-menu ul li a { color: #051922; font-weight: 700; text-decoration: none; padding: 25px 0; display: block; }
        .main-menu ul li a:hover, .main-menu ul li.current-list-item a { color: #F28123; }
        .shopping-cart .cart-count { background-color: #F28123; color: #fff; border-radius: 50%; padding: 2px 6px; font-size: 10px; vertical-align: top; margin-left: 3px; display: inline-block; line-height: 1; min-width: 16px; text-align: center; }
        .float-whatsapp { position: fixed; bottom: 20px; right: 20px; background-color: #25d366; color: #fff; border-radius: 30px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); z-index: 1000; display: flex; align-items: center; padding: 10px 20px; text-decoration: none; transition: background-color 0.3s, transform 0.3s; }
        .float-whatsapp:hover { background-color: #128c7e; transform: scale(1.1); }
        .float-whatsapp i { font-size: 30px; margin-right: 10px; }
        .whatsapp-text { font-size: 16px; font-weight: bold; }
        .hero-area.hero-bg { background-size: cover; background-position: center center; background-repeat: no-repeat; padding: 180px 0; height: auto; }
        .hero-text-tablecell { height: auto; vertical-align: middle; }
        .cart-notification { position: absolute; bottom: -30px; left: 50%; transform: translateX(-50%); background: #4CAF50; color: white; padding: 5px 10px; border-radius: 4px; font-size: 12px; white-space: nowrap; z-index: 100; animation: fadeInOut 2s ease-in-out; }
        @keyframes fadeInOut { 0%, 100% { opacity: 0; } 20%, 80% { opacity: 1; } }
        .single-product-item { position: relative; display: flex; flex-direction: column; height: 100%; }
        .single-product-item .product-image { margin-bottom: 15px; }
        .single-product-item .product-image img { max-width: 100%; height: auto; display: block; }
        .single-product-item .cart-btn { margin-top: 15px; } /* Added for spacing */

        @media (max-width: 991px) {
            .main-menu { display: none; position: absolute; top: 100%; right: 0; background-color: #90EE90; width: 100%; text-align: center; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); z-index: 1001; }
            .main-menu.active { display: block; }
            .main-menu ul li { display: block; margin-left: 0; padding: 5px 10px; border-bottom: 1px solid rgba(255,255,255,0.2); }
            .main-menu ul li:last-child { border-bottom: none; }
            .main-menu ul li a { color: white; padding: 10px 0; font-weight: normal; }
            .hamburger-menu { display: block; }
            .hamburger-menu .bar { background-color: #051922; }
            .header-icons { display: flex; justify-content: center; gap: 20px; padding: 10px; }
            .header-icons a { color: white; font-size: 18px; }
            .shopping-cart .cart-count { background-color: #051922; color: #90EE90; }
            .main-menu ul li .header-icons { border-bottom: none; }
            .float-whatsapp .whatsapp-text { display: none; }
            .float-whatsapp { padding: 12px 15px; }
            .float-whatsapp i { margin-right: 0; font-size: 24px; }
            .hero-area.hero-bg { padding: 100px 0; }
            .footer-box { margin-bottom: 30px; text-align: center; }
            .copyright .col-lg-6 { text-align: center !important; margin-bottom: 10px; }
            .section-title h3 { font-size: 2em; }
            .list-section .list-box { margin-bottom: 30px; }
            .single-product-item { margin-bottom: 30px; }
            .single-product-item .product-image { min-height: auto; display: block; overflow: hidden; margin-bottom: 15px; }
            .single-product-item .product-image img { width: 100%; height: auto; object-fit: cover; display: block; }
            .single-product-item h3 { font-size: 1.1em; margin-bottom: 8px; }
            .single-product-item .product-price { font-size: 1em; margin-bottom: 12px; }
            .single-product-item .cart-btn { padding: 10px 15px; font-size: 1em; }
        }
    </style>
</head>
<body>
    <div id="preloader">
        <div class="progress-loader">
            <div class="progress"></div>
        </div>
    </div>

    <div id="ageVerificationPopup" role="dialog" aria-modal="true" aria-labelledby="ageHeading">
        <p id="ageHeading" class="ageHeading">Age Verification</p>
        <p class="ageDescription">You must be 18 years or older to access this site. Please confirm your age.</p>
        <div class="buttonContainer"> <button class="confirmButton">I am 18+</button> <button class="declineButton">I am under 18</button> </div>
    </div>

    <div id="overlay"></div>

    <div id="loginModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="loginHeading">
        <h2 id="loginHeading">Login</h2> <form id="loginForm"> <input type="email" id="loginEmail" placeholder="Email" required aria-label="Email"> <div class="password-container"> <input type="password" id="loginPassword" placeholder="Password" required aria-label="Password"> <i class="fas fa-eye password-toggle"></i> </div> <button type="submit">Login</button> <button type="button" class="closeButton" aria-label="Close Login Modal">Close</button> </form> <p>Don't have an account? <a href="#" id="showSignupLink">Sign Up</a></p> <div id="loginError" class="error-message"></div>
    </div>

    <div id="signupModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="signupHeading">
        <h2 id="signupHeading">Sign Up</h2> <form id="signupForm"> <input type="text" id="signupName" placeholder="Full Name" required aria-label="Full Name"> <input type="email" id="signupEmail" placeholder="Email" required aria-label="Email"> <div class="password-container"> <input type="password" id="signupPassword" placeholder="Password (min 6 chars)" required aria-label="Password" pattern=".{6,}"> <i class="fas fa-eye password-toggle"></i> </div> <div id="passwordStrength" class="password-strength"></div> <button type="submit">Sign Up</button> <button type="button" class="closeButton" aria-label="Close Signup Modal">Close</button> </form> <p>Already have an account? <a href="#" id="showLoginLink">Login</a></p> <div id="signupError" class="error-message"></div>
    </div>

    <div class="top-header-area" id="sticker">
        <div class="container"> <div class="row"> <div class="col-lg-12 col-sm-12 text-center"> <div class="main-menu-wrap">
            <div class="site-logo"> <a href="index.html"> <img src="assets/img/logo.png" alt="Canapa Delight Logo"> </a> </div>
            <div class="hamburger-menu" onclick="toggleMenu()"> <div class="bar"></div> <div class="bar"></div> <div class="bar"></div> </div>
            <nav class="main-menu"> <ul>
                <li class="current-list-item"><a href="index.html">Home</a></li>
                <li><a href="contact.html">Contact</a></li>
                <li><a href="shop.html">Shop</a></li>
                <li><a href="cart.html">Cart</a></li>
                <li id="loginNav"><a href="#" onclick="showLogin()">Login</a></li>
                <li id="signupNav"><a href="#" onclick="showSignup()">Sign Up</a></li>
                <li id="accountNav" style="display: none;"><a href="account.html">My Account</a></li>
                <li id="logoutNav" style="display: none;"><a href="#" id="logoutButton">Logout</a></li>
                <li> <div class="header-icons"> <a class="shopping-cart" href="cart.html" aria-label="View Shopping Cart"> <i class="fas fa-shopping-cart"></i> <span class="cart-count">0</span> </a> </div> </li>
            </ul> </nav>
        </div> </div> </div> </div>
    </div>

    <main>
        <div class="hero-area hero-bg">
            <div class="container"> <div class="row"> <div class="col-lg-9 offset-lg-2 text-center"> <div class="hero-text"> <div class="hero-text-tablecell">
                <h1 class="subtitle">Canapa Delight</h1>
                <p class="subtitle">A Taste Of Cannabis</p>
                <div class="hero-btns">
                    <a href="shop.html" class="boxed-btn">Our Collection</a>
                    <a href="contact.html" class="bordered-btn">Contact Us</a>
                </div>
            </div> </div> </div> </div> </div>
        </div>
        <div class="list-section pt-80 pb-80">
            <div class="container"> <div class="row">
                <div class="col-lg-4 col-md-6"> <div class="list-box d-flex align-items-center"> <div class="list-icon"> <i class="fas fa-shipping-fast"></i> </div> <div class="content"> <h3>Free Shipping</h3> <p>When order over R500.00</p> </div> </div> </div>
                <div class="col-lg-4 col-md-6"> <div class="list-box d-flex align-items-center"> <div class="list-icon"> <i class="fas fa-phone-volume"></i> </div> <div class="content"> <h3>24/7 Support</h3> </div> </div> </div>
                <div class="col-lg-4 col-md-6"> <div class="list-box d-flex justify-content-start align-items-center"> <div class="list-icon"> <i class="fas fa-sync"></i> </div> <div class="content"> <h3>Refund</h3> <p>Get refund within 3 days!</p> </div> </div> </div>
            </div> </div>
        </div>
        <div class="product-section mt-150 mb-150">
            <div class="container">
                <div class="row"><div class="col-lg-8 offset-lg-2 text-center"><div class="section-title"><h3><span class="orange-text">Our</span> Products</h3><p>Our Cannabis Products</p></div></div></div>
                <div class="row product-lists"> <div class="col-lg-4 col-md-6 text-center">
                    <div class="single-product-item">
                        <div class="product-image"><a href="chocchip.html"><img src="assets/img/products/product-img-1.jpg" alt="Choc Chip Cookies" loading="lazy"></a></div>
                        <h3>Choc Chip Cookies</h3>
                        <p class="product-price"><span>10mg THC - 10 cookies</span> R150.00</p>
                        <button class="cart-btn" data-product-id="1"><i class="fas fa-shopping-cart"></i> Add to Cart</button>
                    </div>
                </div>
                <div class="col-lg-4 col-md-6 text-center">
                    <div class="single-product-item">
                        <div class="product-image"><a href="yummygummies.html"><img src="assets/img/products/product-img-2.jpg" alt="Yummy Gummies" loading="lazy"></a></div>
                        <h3>Yummy Gummies</h3>
                        <p class="product-price"><span>20mg THC - 10 pieces</span> R250.00</p>
                        <button class="cart-btn" data-product-id="7"><i class="fas fa-shopping-cart"></i> Add to Cart</button>
                    </div>
                </div>
                <div class="col-lg-4 col-md-6 offset-md-3 offset-lg-0 text-center">
                    <div class="single-product-item">
                        <div class="product-image"><a href="durbansativa.html"><img src="assets/img/products/product-img-3.jpg" alt="Durban Poison Sativa Vape" loading="lazy"></a></div>
                        <h3>Durban Poison Sativa</h3>
                        <p class="product-price"><span>1ml THC Disposable</span> R1000.00</p>
                        <button class="cart-btn" data-product-id="18"><i class="fas fa-shopping-cart"></i> Add to Cart</button>
                    </div>
                </div>
                </div>
                <div style="text-align: center; padding: 20px;"><a href="shop.html" class="boxed-btn"><i class="fas fa-shopping-cart"></i> Shop All our Products</a></div>
            </div>
        </div>
        <section class="cart-banner pt-100 pb-100">
             <div class="container"> <div class="row clearfix">
                 <div class="image-column col-lg-6"><div class="image"><img src="assets/img/a.jpg" alt="Promotional Banner Image" loading="lazy"></div></div>
                 <div class="content-column col-lg-6"><h3><span class="orange-text">Deal</span> of the month</h3><h4>Canapa Delight</h4><div class="text">buy 3 get 1 free</div><a href="cart.html" class="cart-btn mt-3"><i class="fas fa-shopping-cart"></i> Add to Cart</a></div>
             </div> </div>

        </section>
        </main>

    <footer class="footer-area"> <div class="container"> <div class="row"> <div class="col-lg-3 col-md-6"> <div class="footer-box about-widget"> <h2 class="widget-title">About us</h2> <p>Discover high-quality, curated cannabis products at Canapa Delights.</p> </div> </div> <div class="col-lg-3 col-md-6"> <div class="footer-box get-in-touch"> <h2 class="widget-title">Get in Touch</h2> <ul> <li>22 Karee Street, Southdowns Shopping Centre, Irene</li> <li>Email: <span class="safe-email" data-user="canapadelight" data-domain="gmail.com">Loading...</span></li> <li><a href="tel:+27710314435">+27 71 031 4435</a></li> </ul> </div> </div> <div class="col-lg-3 col-md-6"> <div class="footer-box"> <h2 class="widget-title">Follow Us</h2> <div class="social-icons"> <a href="https://facebook.com/yourpage" target="_blank" aria-label="Visit our Facebook page"><i class="fab fa-facebook-f"></i></a> <a href="https://instagram.com/yourpage" target="_blank" aria-label="Visit our Instagram page"><i class="fab fa-instagram"></i></a> </div> </div> </div> </div> </div> </footer>
    <div class="copyright"> <div class="container"> <div class="row"> <div class="col-lg-6 col-md-12"><p>Copyright &copy; 2025 - All Rights Reserved.</p></div> <div class="col-lg-6 text-right col-md-12"><div class="social-icons"><ul><li><a href="https://facebook.com/yourpage" target="_blank" aria-label="Visit our Facebook page"><i class="fab fa-facebook-f"></i></a></li><li><a href="https://instagram.com/yourpage" target="_blank" aria-label="Visit our Instagram page"><i class="fab fa-instagram"></i></a></li></ul></div></div> </div> </div> </div>

    <a href="https://wa.me/27710314435" class="float-whatsapp" target="_blank"> <i class="fab fa-whatsapp"></i> <span class="whatsapp-text">Chat with us</span> </a>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-auth.js";
        import { getDatabase, ref, set, serverTimestamp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCiJnj-Z9TXTeMelX_CTw8KM28_BaQW6bo",
            authDomain: "canapa-delight.firebaseapp.com",
            databaseURL: "https://canapa-delight-default-rtdb.firebaseio.com",
            projectId: "canapa-delight",
            storageBucket: "canapa-delight.appspot.com",
            messagingSenderId: "35385881641",
            appId: "1:35385881641:web:846ac0863099c5c64c1838",
            measurementId: "G-6GMPH5C04L"
        };

        let auth, database;
        try { const app = initializeApp(firebaseConfig); auth = getAuth(app); database = getDatabase(app); console.log("Firebase initialized successfully for Index Page");
        } catch (error) { console.error("Firebase initialization error:", error); }

        const agePopup = document.getElementById('ageVerificationPopup');
        const overlay = document.getElementById('overlay');
        const loginModal = document.getElementById('loginModal');
        const signupModal = document.getElementById('signupModal');
        const loginForm = document.getElementById('loginForm');
        const signupForm = document.getElementById('signupForm');
        const loginError = document.getElementById('loginError');
        const signupError = document.getElementById('signupError');
        const passwordToggles = document.querySelectorAll('.password-toggle');
        const signupPasswordInput = document.getElementById('signupPassword');
        const passwordStrengthDiv = document.getElementById('passwordStrength');
        const loginNav = document.getElementById('loginNav');
        const signupNav = document.getElementById('signupNav');
        const accountNav = document.getElementById('accountNav');
        const logoutNav = document.getElementById('logoutNav');
        const logoutButton = document.getElementById('logoutButton');
        const mainMenu = document.querySelector('.main-menu');

        const showModal = (modal) => { if(modal) { modal.style.display = 'block'; overlay.style.display = 'block'; modal.querySelector('input, button')?.focus(); }};
        const hideModal = (modal) => { if(modal) modal.style.display = 'none'; };
        const closeAllModals = () => { hideModal(loginModal); hideModal(signupModal); if(overlay) overlay.style.display = 'none'; };
        const displayError = (element, error) => { if(element) element.textContent = "Error: " + error.message.replace('Firebase: ', ''); console.error(error); };
        const setLoading = (button, isLoading, originalText) => { if(button) { button.disabled = isLoading; button.textContent = isLoading ? 'Processing...' : originalText; }};
        const checkPasswordStrength = (password) => {
            if (!passwordStrengthDiv) return; let strength = 0;
            if (password.length >= 8) strength++; if (password.match(/[a-z]/)) strength++; if (password.match(/[A-Z]/)) strength++;
            if (password.match(/[0-9]/)) strength++; if (password.match(/[^a-zA-Z0-9]/)) strength++;
            switch (strength) { case 0: case 1: case 2: passwordStrengthDiv.textContent = 'Weak'; passwordStrengthDiv.style.color = 'red'; break;
                case 3: passwordStrengthDiv.textContent = 'Medium'; passwordStrengthDiv.style.color = 'orange'; break;
                case 4: case 5: passwordStrengthDiv.textContent = 'Strong'; passwordStrengthDiv.style.color = 'green'; break;
                default: passwordStrengthDiv.textContent = ''; break; }
             if (!password) passwordStrengthDiv.textContent = '';
        };
        const handleAgeVerification = () => {
            if (!agePopup) return;
             if (!sessionStorage.getItem('ageVerified') && !localStorage.getItem('ageVerified')) {
                 agePopup.style.display = 'block'; if(overlay) overlay.style.display = 'block'; }
            const confirmBtn = agePopup.querySelector('.confirmButton'); const declineBtn = agePopup.querySelector('.declineButton');
            if (confirmBtn) { confirmBtn.addEventListener('click', () => { localStorage.setItem('ageVerified', 'true'); sessionStorage.setItem('ageVerified', 'true'); agePopup.style.display = 'none'; if(overlay) overlay.style.display = 'none'; }); }
            if (declineBtn) { declineBtn.addEventListener('click', () => { alert("You must be 18 or older to enter."); window.location.href = 'https://www.google.com'; }); }
        };
        window.showLogin = () => { hideModal(signupModal); showModal(loginModal); if(loginError) loginError.textContent = ''; };
        window.showSignup = () => { hideModal(loginModal); showModal(signupModal); if(signupError) signupError.textContent = ''; };
        window.toggleMenu = () => { if(mainMenu) mainMenu.classList.toggle('active'); };

        class CartSystem { // Kept for header count, and featured product "Add to Cart"
            constructor() { this.cart = JSON.parse(localStorage.getItem('cart')) || []; this.initHomePage(); }
            initHomePage() { this.updateHeaderCartCount(); this.setupAddToCartListeners(); }
            setupAddToCartListeners() {
                document.querySelectorAll('.product-section .cart-btn, .cart-banner .cart-btn').forEach(btn => { // Target specific add to cart buttons
                    const newBtn = btn.cloneNode(true); btn.parentNode.replaceChild(newBtn, btn);
                    newBtn.addEventListener('click', (e) => this.addToCart(e)); });
            }
            addToCart(e) {
                const button = e.target.closest('.cart-btn'); if (!button) return;
                const productCard = button.closest('.single-product-item');
                let productData = {};

                if (productCard) { // For featured products
                    const priceTextElement = productCard.querySelector('.product-price'); let price = 0;
                    if (priceTextElement) { const priceMatch = priceTextElement.textContent.match(/R([\d.]+)/); price = priceMatch ? parseFloat(priceMatch[1]) : 0; }
                    const nameElement = productCard.querySelector('h3'); const imageElement = productCard.querySelector('img');
                    productData = { id: button.dataset.productId, name: nameElement ? nameElement.textContent : 'Unknown Product', price: price, image: imageElement ? imageElement.src : 'assets/img/default-product.png', quantity: 1 };
                } else if (button.closest('.cart-banner')) { // For deal of the month banner
                    // You'll need to define the product details for the deal of the month
                    // This is a placeholder - update with actual product ID, name, price for the deal
                    productData = { id: "deal-of-month-product-id", name: "Deal of the Month Special", price: 0.00 /* Update this */, image: "assets/img/a.jpg", quantity: 1 };
                    alert("Deal of the month added to cart! (Price needs to be set)"); // Temporary
                } else {
                    return; // Not a recognized add to cart context
                }

                const existingItem = this.cart.find(item => item.id === productData.id);
                if (existingItem) { existingItem.quantity++; } else { this.cart.push(productData); }
                localStorage.setItem('cart', JSON.stringify(this.cart)); this.updateHeaderCartCount();
                if(productCard) this.showAddedNotification(button); // Only show for product cards
            }
            updateHeaderCartCount() { const count = this.cart.reduce((sum, item) => sum + item.quantity, 0); const cartCountSpan = document.querySelector('.cart-count'); if(cartCountSpan) { cartCountSpan.textContent = count; }}
            showAddedNotification(button) {
                const parentNode = button.parentNode; if (!parentNode) return;
                const existingNotif = parentNode.querySelector('.cart-notification'); if (existingNotif) existingNotif.remove();
                const notification = document.createElement('div'); notification.className = 'cart-notification'; notification.textContent = 'Added to cart!';
                parentNode.appendChild(notification); setTimeout(() => notification.remove(), 2000);
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            if(agePopup) handleAgeVerification();
            const showSignupLink = document.getElementById('showSignupLink'); const showLoginLink = document.getElementById('showLoginLink');
            if(showSignupLink) showSignupLink.addEventListener('click', (e) => { e.preventDefault(); showSignup(); });
            if(showLoginLink) showLoginLink.addEventListener('click', (e) => { e.preventDefault(); showLogin(); });
            document.querySelectorAll('.closeButton').forEach(btn => btn.addEventListener('click', closeAllModals));
            if(overlay) overlay.addEventListener('click', closeAllModals);
            document.querySelectorAll('.modal').forEach(modal => modal.addEventListener('click', (e) => e.stopPropagation()));
            document.addEventListener('keydown', (e) => { if (e.key === "Escape" && overlay && overlay.style.display === 'block') { closeAllModals(); } });
            passwordToggles.forEach(toggle => { toggle.addEventListener('click', () => { const passwordInput = toggle.previousElementSibling; if(passwordInput) { const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password'; passwordInput.setAttribute('type', type); toggle.classList.toggle('fa-eye'); toggle.classList.toggle('fa-eye-slash'); }}); });
            if (signupPasswordInput) { signupPasswordInput.addEventListener('input', () => checkPasswordStrength(signupPasswordInput.value)); }
            if (loginForm) { loginForm.addEventListener('submit', async (e) => { e.preventDefault(); const email = document.getElementById('loginEmail').value; const password = document.getElementById('loginPassword').value; const button = e.target.querySelector('button[type="submit"]'); setLoading(button, true, 'Login'); if(loginError) loginError.textContent = ''; try { await signInWithEmailAndPassword(auth, email, password); closeAllModals(); alert("Logged in successfully!"); } catch (error) { if(loginError) displayError(loginError, error); } finally { setLoading(button, false, 'Login'); }}); }
            if (signupForm) { signupForm.addEventListener('submit', async (e) => { e.preventDefault(); const name = document.getElementById('signupName').value; const email = document.getElementById('signupEmail').value; const password = document.getElementById('signupPassword').value; const button = e.target.querySelector('button[type="submit"]'); if (password.length < 6) { if(signupError) signupError.textContent = "Password must be at least 6 characters long."; return; } setLoading(button, true, 'Sign Up'); if(signupError) signupError.textContent = ''; try { const userCredential = await createUserWithEmailAndPassword(auth, email, password); const user = userCredential.user; await set(ref(database, 'users/' + user.uid), { name: name, email: email, createdAt: serverTimestamp() }); closeAllModals(); alert("Account created successfully!"); } catch (error) { if(signupError) displayError(signupError, error); } finally { setLoading(button, false, 'Sign Up'); }}); }
            if (logoutButton) { logoutButton.addEventListener('click', async (e) => { e.preventDefault(); try { await signOut(auth); alert("Logged out successfully!"); } catch (error) { console.error("Logout Error:", error); alert("Failed to log out."); }}); }
            new CartSystem(); // Initialize Cart System for adding to cart and updating header count
            document.querySelectorAll('.safe-email').forEach(element => { const user = element.dataset.user; const domain = element.dataset.domain; element.innerHTML = `<a href="mailto:${user}@${domain}">${user}@${domain}</a>`; });
        });
        if (auth) { onAuthStateChanged(auth, (user) => { if (user) { if(loginNav) loginNav.style.display = 'none'; if(signupNav) signupNav.style.display = 'none'; if(accountNav) accountNav.style.display = 'inline-block'; if(logoutNav) logoutNav.style.display = 'inline-block'; } else { if(loginNav) loginNav.style.display = 'inline-block'; if(signupNav) signupNav.style.display = 'inline-block'; if(accountNav) accountNav.style.display = 'none'; if(logoutNav) logoutNav.style.display = 'none'; }}); }
    </script>

    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script src="assets/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="assets/js/jquery.countdown.js"></script>
    <script src="assets/js/jquery.isotope-3.0.6.min.js"></script>
    <script src="assets/js/waypoints.js"></script>
    <script src="assets/js/owl.carousel.min.js"></script>
    <script src="assets/js/jquery.magnific-popup.min.js"></script>
    <script src="assets/js/sticker.js"></script>
    <script src="assets/js/main.js"></script>

    <script>
        // Hide preloader when everything is loaded
        window.addEventListener('load', function() {
            const preloader = document.getElementById('preloader');
            
            // Function to hide the preloader
            function hidePreloader() {
                if (preloader) {
                    // Fade out the preloader
                    preloader.style.opacity = '0';
                    
                    // Remove it from the DOM after fade out completes
                    setTimeout(function() {
                        preloader.style.display = 'none';
                    }, 500);
                }
            }

            // Wait 2 seconds (2000 milliseconds) AFTER the page is loaded, then hide it
            setTimeout(hidePreloader, 2000); 
        });
    </script>
    
    <script>
        // Show preloader when navigating away from the page
        document.addEventListener('DOMContentLoaded', function() {
            const links = document.querySelectorAll('a[href]:not([target="_blank"]):not([href^="#"]):not([href^="javascript"])');
            
            links.forEach(link => {
                link.addEventListener('click', function(e) {
                    // Don't intercept if it's a hash link or special javascript action
                    if (this.href.includes('#') || this.href.startsWith('javascript:')) return;
                    
                    // Show preloader
                    const preloader = document.getElementById('preloader');
                    if (preloader) {
                        preloader.style.display = 'flex'; // Use flex to re-enable centering
                        preloader.style.opacity = '1';
                    }
                });
            });
        });
    </script>
</body>
</html>